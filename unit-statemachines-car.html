<html lang="en-US"><head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>TTM4115</title>
<meta property="og:title" content="TTM4115">
<meta property="og:locale" content="en_US">
<meta name="description" content="Design of Communicating Systems">
<meta property="og:description" content="Design of Communicating Systems">


<!--<link rel="stylesheet" type="text/css" href="style.css" />-->
<!--<link href="https://fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Source+Code+Pro|Source+Sans+Pro:200,300,400,600,400italic,600italic|Rock+Salt" rel="stylesheet" type="text/css">-->


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

<link href="assets/bootstrap.min.css" rel="stylesheet">


<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous">

<link rel="stylesheet" type="text/css" href="assets/style.css" />
<link rel="stylesheet" type="text/css" href="assets/bootstrap-icons.css">

<script src="assets/anchor.js"></script>
<script src="assets/script-aside.js"></script>
<style type="text/css">div.delivery p {
  padding: 10px;
  background-color: #ffd9ab;
  font-family: "Source Sans Pro", Georgia, serif;
  border-radius: 5px;
  border-left: 6px solid #fc8c03; 
}
  
div.delivery p::before {
  content: 'Delivery: ';
  font-family: "Source Sans Pro", Georgia, serif;
  color: #fc8c03;
  display: inline;
  font-weight: bold;
}
div.figure {
  padding: 20px 0 20px 0;
  width: 100%;
}

div.figurefullwitdth {
  padding: 20px 0 20px 0;
  margin-left: -33px;
  margin-right: -33px;
  width: 100%;
}
div.goals ul,
div.goals ul li {
  padding: 0;
  margin: 0;
  list-style: none;
}

div.goals ul {
  margin: 2em 0;
}

div.goals ul li {
  margin: 1em;
  margin-left: 3em;
}

div.goals ul li:before {
  content: '\f26a';
  font-family: bootstrap-icons !important;
  font-size:20;
  float: left;
  margin-left: -1.5em;
  color: #1481b8;
}
.w3collapsible {
  background-color:#f0e9db;
  color: #868279; 
  padding: 8px 18px 8px 8px;
  cursor: pointer;
  width: 100%;
  border: none;
  border-radius: 3px 3px 0 0;
  text-align: left;
  outline: none;
  font-size: 15px;
}

.w3active, .w3collapsible:hover {
  background-color: #f0e9cb;
}

.w3content {
  filter: blur(3px);
  padding: 0 18px;
  display: block;
  overflow: hidden;
  background-color: #f3f3f3;
  margin-bottom: 15px;
}
div.rat ol {
  list-style-type: upper-alpha;
}
/*tr.rubric_title {background-color: lightgrey}*/
/*tr.rubric_a {background-color: #D0E8DC}
tr.rubric_b {background-color: #EEF7DB}
tr.rubric_c {background-color: #FCFDE3}
tr.rubric_d {background-color: #FDF3D6}
tr.rubric_e {background-color: #F8D9C2}
tr.rubric_f {background-color: #EBBCB9}

tr.rubric_title {background-color: white; 
	border-top: 2px black solid; 
	border-bottom: 2px black solid;}
td.rubric_title {background-color: white;}
td.rubric_a {background-color: #D0E8DC}
td.rubric_b {background-color: #EEF7DB}
td.rubric_c {background-color: #FCFDE3}
td.rubric_d {background-color: #FDF3D6}
td.rubric_e {background-color: #F8D9C2}
td.rubric_f {background-color: #EBBCB9}

th.rubric_title {background-color: white}
th.rubric_a {background-color: #D0E8DC}
th.rubric_b {background-color: #EEF7DB}
th.rubric_c {background-color: #FCFDE3}
th.rubric_d {background-color: #FDF3D6}
th.rubric_e {background-color: #F8D9C2}
th.rubric_f {background-color: #EBBCB9}

table.rubric th {border-top: 2px black solid; border-bottom: 2px black solid; text-align: center;
	vertical-align:top;}
table.rubric td {width:22%; border-bottom: 1px black solid;}}*/

.rubric p {margin: 0px}
.rubric th {border-top: 1.4px black solid; border-bottom: 1.4px black solid; text-align: center; padding:6px;}
.rubric td {border-bottom: 0.7px black solid; vertical-align:top; font-size:12px; padding:6px;}
.rubric th {font-size:12px; vertical-align:top; }
.rubric td:nth-child(2), .rubric th:nth-child(2){background-color: #D0E8DC; width:22%}
.rubric td:nth-child(3), .rubric th:nth-child(3){background-color: #FCFDE3; width:22%}
.rubric td:nth-child(4), .rubric th:nth-child(4){background-color: #F8D9C2; width:22%}
.rubric td:nth-child(5), .rubric th:nth-child(5){background-color: #EBBCB9; width:22%}
.rubric tfoot td {text-align:right; border-bottom: none; padding: 1px;}
.rubric tfoot a {font-size: 12px; font-style: italic; color: gray}

div.tip p {
  padding: 10px;
  background-color: #d9eaf2;
  border-radius: 5px;
  border-left: 6px solid #1481b8
}

</style>
</head>
<body id="top">

<nav class="navbar navbar-expand-md navbar-dark " style="background-color:#666666"#2B65EC"> <!-- fixed-top -->
        <ul class="nav nav-pills">
        <li class="nav-item">
    <a class="nav-link" href="index.html" style="font-weight: bold")>TTM4115</a>
  </li>
        
  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Preparation</a>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="prep-setup.html"><b>1.</b> Introduction and Setup</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="prep-modeling.html"><b>2.</b> Modeling and Deployment</a>
      <a class="dropdown-item" href="prep-statemachines.html"><b>3.</b> State Machines</a>
      <a class="dropdown-item" href="prep-user-requirements.html"><b>4.</b> User Requirements</a>
      <a class="dropdown-item" href="prep-stmpy.html"><b>5.</b> State Machines in Python</a>
      <a class="dropdown-item" href="prep-agile.html"><b>6.</b> Agile Development</a>
      <a class="dropdown-item" href="prep-communication.html"><b>7.</b> Communication</a>
      <a class="dropdown-item" href="prep-interactions.html"><b>8.</b> Interactions</a>
      <a class="dropdown-item" href="prep-components.html"><b>9.</b> Components</a>
    </div>
  </li>
  
  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Activities</a>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="unit-setup.html"><b>1.</b> Team Setup</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="unit-modeling.html"<b>2.</b> Modeling and Deployment</a>
      <a class="dropdown-item" href="unit-statemachines.html"><b>3.</b> State Machines</a>
      <a class="dropdown-item" href="unit-user-requirements.html"><b>4.</b> User Requirements</a>
      <a class="dropdown-item" href="unit-stmpy.html"><b>5.</b> State Machines in Python</a>
  	  <a class="dropdown-item" href="unit-agile.html"><b>6.</b> Agile Development</a>
      <a class="dropdown-item" href="unit-communication.html"><b>7.</b> Communication</a>
      <a class="dropdown-item" href="unit-interactions.html"><b>8.</b> Interactions</a>
      <a class="dropdown-item" href="unit-components.html"><b>9.</b> Components</a>
    </div>
  </li>
  
  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Focus</a>
    <div class="dropdown-menu">
    <a class="dropdown-item" href="unit-modeling-diagram-tips.html">Diagram Tips</a>
    <a class="dropdown-item" href="unit-statemachines-data.html">State Machines — Data vs. States</a>
    <a class="dropdown-item" href="unit-statemachines-car.html">Focus: State Machines — Car Lock Example</a>
    <a class="dropdown-item" href="unit-statemachines-head.html">Focus: State Machines — Headphones Exercise</a>
    <a class="dropdown-item" href="unit-components-tips.html">Tips: Components</a>
    </div>
  </li>
  
  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Deliveries</a>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="deliveries.html">Deliveries Overview</a>
      <a class="dropdown-item" href="deliveries-project.html">Semester Project</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="deliveries-t1.html">System Spec, version 1</a>
      <a class="dropdown-item" href="deliveries-i1.html">Feedback on version 1</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="deliveries-t2.html">System Spec, version 2</a>
      <a class="dropdown-item" href="deliveries-i2.html">Feedback on version 2</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="deliveries-t3.html">System Spec, final version</a>
      <a class="dropdown-item" href="deliveries-i3.html">Individual Reflection</a>
    </div>
  </li>

  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Tools</a>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="tools.html">Tools Overview</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="tools-python.html">Python</a>
	    <a class="dropdown-item" href="tools-gui.html">Python GUIs with appJar</a>
      <a class="dropdown-item" href="tools-notebooks.html">Python Notebooks</a>
      <a class="dropdown-item" href="tools-mqtt.html">MQTT</a>
      <a class="dropdown-item" href="tools-stmpy.html">STMPY</a>
	  <a class="dropdown-item" href="tools-base.html">Base Architecture</a>
    </div>
  </li>
  
  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Learning</a>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="learning-goals.html">Learning Goals</a>
      <a class="dropdown-item" href="learning-tbl.html">Team-Based Learning</a>
      <a class="dropdown-item" href="learning-teamwork.html">Teamwork Procedures</a>
      <a class="dropdown-item" href="learning-reflection.html">Reflection</a>
      <a class="dropdown-item" href="feedback.html">Feedback</a>
      <a class="dropdown-item" href="learning-grading.html">Grading</a>
      <!--<a class="dropdown-item" href="learning-areas.html">Working Areas</a>-->
      <!--<a class="dropdown-item" href="learning-expectations.html">Expectations</a>-->
    </div>
  </li>
  <!--
  <li class="nav-item">
    <a class="nav-link" href="#">Blackboard</a>
  </li>-->
</ul>

<div class="navbar-nav flex-row ml-md-auto d-none d-md-flex"></div>
             <a class="navbar-brand" href="https://ntnu.edu" title="NTNU Homepage">
      	<svg width="100" height="30">
      		<image xlink:href="https://innsida.ntnu.no/innsida-theme/images/ntnu-graphics/ntnu_logo_white.svg" 
      		src="https://innsida.ntnu.no/innsida-theme/images/ntnu-graphics/ntnu_logo_white.png" width="100%" height="100%" alt="NTNU Logo"></image>
      	</svg>
      </a>
    </nav>


<div class="page">
    </section>
    <section class="content">
<h1>Car Lock</h1>
<p>You should design the controller of a car lock. The controller is one of several modules in the car, which are connected via a CAN-bus, that sends signals between the modules.
The controller gets input from the remote car key, which can send the commands <code>key_unlock</code> and <code>key_lock</code>. (The necessary encryption and security mechanisms are implemented between the car key and the key component, but not detailed here.) The controller send the signals <code>unlock</code> and <code>lock</code> to the lock component. It can also detect if the car door was opened or closed, via the signals <code>door_opened</code> and <code>door_closed</code>. Below is a diagram that illustrates all components and the CAN bus.</p>

<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;lightbox&quot;:false,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;url&quot;:&quot;https://drive.google.com/uc?id=1ZX0ZxYLXXpE4ZLAdk7D39M1mdFLEcA7T&amp;export=download&quot;}"></div>
<script type="text/javascript" src="https://www.draw.io/embed2.js?&fetch=https%3A%2F%2Fdrive.google.com%2Fuc%3Fid%3D1ZX0ZxYLXXpE4ZLAdk7D39M1mdFLEcA7T%26export%3Ddownload"></script>



<p>The following are the functional requirements for the controller:</p>
<ul>
<li><strong>R1.1:</strong> When the button <code>Unlock</code> is pressed, the door is unlocked.</li>
<li><strong>R1.2:</strong> When the button <code>Lock</code> is pressed, the door is locked.</li>
<li>Assume that the controller starts in a state where the door is closed and the lock is locked.</li>
</ul>
<p>The following signals are sent between the components via the CAN-bus:</p>
<ul>
<li>From Remote Key Controller to Car Lock Controller: <code>key_unlock</code>, <code>key_lock</code></li>
<li>From Car Lock Controller to Door Controller: <code>unlock</code>, <code>lock</code></li>
<li>From Door Controller to Car Lock Controller: <code>door_opened</code>, <code>door_closed</code></li>
</ul>
<p>To send a signal, use method <code>send_signal('...')</code> with the signal name as argument.
To react on the reception of a signal, simply write that signals as the trigger of a transition.</p>
<p>Design a state machine in draw.io for the Car Lock Controller that keeps track of the state of the door and the lock, and that implements the functional requirements from above.</p>

<div class="figure">
<img src="figures/statemachines/car-lock-1.png" width="100%"/>
</div>
<p>Now, add the following functional requirement and create another version of the state machine. (Edit as a copy of the sheet.)</p>
<ul>
<li><strong>R2.1:</strong> If a door is unlocked but not opened, it is locked again after 60 seconds.</li>
</ul>
<p>This implies that we add a timer to the state machine with a transition reacting to it once the timer expires. We do this in the state machine below. It is important that we use the exit/stop_timer(t) action to state <code>closed_unlocked</code>, to prevent a sequence where the user quickly opens the door, then closes it again, then the timer (which was not stopped) to expire and the lock to close. This is prevented by explicitly stopping the timer.</p>

<div class="figure">
<img src="figures/statemachines/car-lock-2.png" width="100%"/>
</div>
<p>Another solution adds an additional state, here called <code>closed_unlocked_timed</code>. This state covers explicitly that the timer is active, and we leave this state either by the timer expiration or by opening the door.</p>

<div class="figure">
<img src="figures/statemachines/car-lock-3.png" width="100%"/>
</div>
    </section>
</div>


<footer></footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script>













</script>
<script>
  anchors.options.visible = 'touch';
  anchors.add("h1, h2, h3");
</script>
</body>
</html>