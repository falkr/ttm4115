<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="generator" content="">
  <title>TTM4115</title>
  <link rel="canonical" href="https://edu.iik.ntnu.no">
  <!-- Bootstrap core CSS -->
    <link href="../assets/bootstrap.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="../assets/style-frame.css" rel="stylesheet">
    <link href="../assets/style-fonts.css" rel="stylesheet">
    <link href="../assets/style-code.css" rel="stylesheet">
    <link rel="stylesheet" href="../assets/bootstrap-icons.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"></script>
    <script src="../assets/anchor.js"></script>
    <script src="../assets/clipboard.min.js"></script>
    <script src="../assets/script-aside.js"></script>
    <style>/* === figure === */
div.figure {
  padding: 20px 0 20px 0;
  width: 100%;
}

div.figurefullwitdth {
  padding: 20px 0 20px 0;
  margin-left: -33px;
  margin-right: -33px;
  width: 100%;
}

figcaption {
  color: #868279;
}

</style>
  </head>
  
  <body>

  
  



<nav class="navbar navbar-expand-lg navbar shadow-sm">
  <div class="container-fluid">
    <a class="navbar-brand" href="https://ntnu.edu" title="NTNU Homepage">
      <img id="header_logo" alt="NTNU Hjemmeside" width="120px" src="https://www.ntnu.no/o/ntnu-theme/images/logo_ntnu.svg" height="23px">
    </a>
    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="../index.html">TTM4115</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Units
          </a>
          <ul class="dropdown-menu dropdown-menu">
            <a class="dropdown-item" href="../unit-1-setup/index.html">Unit 1: Introduction and Setup</a>
            <a class="dropdown-item" href="../unit-2-models/index.html">Unit 2: Modeling and Deployment Diagrams</a>
            <a class="dropdown-item" href="../unit-3-stm/index.html">Unit 3: State Machines</a>
            <a class="dropdown-item" href="../unit-4-req/index.html">Unit 4: User Requirements</a>
            <a class="dropdown-item" href="../unit-5-stmpy/index.html">Unit 5: State Machines in Python</a>
            <a class="dropdown-item" href="../unit-6-agile/index.html">Unit 6: Agile Development</a>
            <a class="dropdown-item" href="../unit-7-comm/index.html">Unit 7: Communication</a>
            <a class="dropdown-item" href="../unit-8-sd/index.html">Unit 8: Interactions</a>
            <a class="dropdown-item" href="../unit-9-comp/index.html">Unit 9: Components</a>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Project
          </a>
          <ul class="dropdown-menu dropdown-menu">
            <a class="dropdown-item" href="../project/index.html">Semester Project</a>
            <a class="dropdown-item" href="../project/deliveries-t1.html">Specification 1</a>
            <a class="dropdown-item" href="../project/deliveries-i1.html">Feedback on Specification 1</a>
            <a class="dropdown-item" href="../project/deliveries-t2.html">Specification 2</a>
            <a class="dropdown-item" href="../project/deliveries-i2.html">Feedback on Specification 2</a>
            <a class="dropdown-item" href="../project/deliveries-t3.html">Specification 3 (Final)</a>
            <a class="dropdown-item" href="../project/deliveries-i3.html">Individual Reflective Essay</a>
            
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Learning
          </a>
          <ul class="dropdown-menu dropdown-menu">
            <a class="dropdown-item" href="../learning/feedback.html">Teachers and Feedback</a>
            <a class="dropdown-item" href="../learning/goals.html">Learning Goals</a>
            <a class="dropdown-item" href="../learning/grading.html">Grading</a>
            <a class="dropdown-item" href="../learning/reflection.html">Reflection</a>
            <a class="dropdown-item" href="../learning/tbl.html">Team-Based Learning</a>
            <a class="dropdown-item" href="../learning/teamwork.html">Teamwork</a>
            <a class="dropdown-item" href="../schedule.html">Schedule</a>
            <a class="dropdown-item" href="../learning/remote.html">For Remote Teams</a>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Tools
          </a>
          <ul class="dropdown-menu dropdown-menu">
            <a class="dropdown-item" href="../tools/index.html">Tools</a>
            <!--<a class="dropdown-item" href="../tools/tools-python.html">Python</a>-->
            <a class="dropdown-item" href="../tools/tools-gui.html">GUIs in Python</a>    
            <a class="dropdown-item" href="../tools/tools-mqtt.html">MQTT</a>            
            <a class="dropdown-item" href="../tools/tools-notebooks.html">Notebooks</a>
            <a class="dropdown-item" href="../tools/tools-stmpy.html">STMPY</a>            
          </ul>
        </li>
      </ul>
      <div class="bg-light border ms-auto"></div>
        <div>
        <a class="nav-link" href="../schedule.html"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar3" viewBox="0 0 16 16">
          <path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z"/>
          <path d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
        </svg></a>
      </div>
    </div>
  </div>
</nav>



  <main class="container container-max-width">
    <nav style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E&#34;);" aria-label="breadcrumb">
<ol class="breadcrumb">
<li class="breadcrumb-item"><a href="../index.html">TTM4115</a></li>
<li class="breadcrumb-item"><a href="index.html">Unit 8: Interactions</a></li>
<li class="breadcrumb-item active" aria-current="page">Intuition on Sequence Diagrams</li>
</ol>
</nav>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>Intuition on Sequence Diagrams</h1>
<p>An important difference to state machines is that sequence diagrams
usually do not model complete behaviors, but only show selected
scenarios that a developer wants to show. More on that later. Let's
first get some intuition on sequence diagrams.</p>
<p>Sequence diagrams are an effective and intuitive way to describe the
communication between several communicating partners. Have a look at the
following dialogue:</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/intuition.png" class="figure-img img-fluid rounded" alt="A sequence diagram showing a conversation.">
</figure></div><aside class="col-md-4 chunk ps-2"><figcaption class="figure-caption">A sequence diagram showing a conversation.</figcaption></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>That's pretty much how sequence diagrams work, they show messages
between participants. Each participant in a sequence diagram is
represented by a vertical line, called <em>lifeline</em>. The horizontal lines
are messages. Time flows downwards, so that the messages make up a
conversation.</p>
<p>With this little knowledge, you can already understand most sequence
diagrams. What follows are refinements of this concept and additional
modeling elements so we can more precisely express how a software system
communicates. This is necessary to prevent misunderstandings between
developers and when we want to detect design flaws in our systems at an
early stage.</p>
<h2>Participants and Lifelines</h2>
<p>Each participant in a sequence diagram is represented by a lifeline,
shown as dashed lines. It's okay to show them as solid lines, which may
sometimes be quicker when you make a sketch by hand. Lifelines are
always drawn parallel to each other, and follow a vertical orientation.
You will never see a sequence diagram with horizontal lifelines. If you
do, it's not a sequence diagram.</p>
<p>Lifelines can represent software concepts like components, modules,
objects or classes. They can also represent entities from reality, like
human users. The diagram below shows how a human user who presses a
button on a car key. The car key then sends a radio signal to the car,
which in turn confirms to the user by blinking the lights.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/car-key.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>The top of the lifeline shows a box that refers to what the participant
represents in this sequence diagram. The label in this box consists of
three parts: a role name, a selector, a class name.</p>
<pre><code>role[selector]:Class
</code></pre>
<p>Let's look at an example to understand the difference between these.
Below you see a sequence diagram of a home automation system. There are
several <strong>roles</strong>: <em>sensor</em> and <em>light</em>. The role name is a name that
refers to the participant's function within an interaction. From the
lifelines that represent sensors, the diagram shows that there are two
<strong>classes</strong> of sensors, <em>TempSensor</em> and <em>HumiditySensor</em>. All of them
act as sensors in the system (and hence send signals with the name
<em>measurement</em>), which is why they all share the same role. All
components communicate with the central unit. Here we have chosen to
just give it a class name <em>HouseCentral</em>, since there is only one and we
already know that we want to have this class. An alternative would be to
just give it a role name, for instance <em>central</em>. You can also see that
the sensors have different <strong>selectors</strong>, which here are strings that
refer to different rooms. They show that there can be many sensors (role
<em>sensor</em> of the same class (for instance <em>TempSensor</em>). Here, room names
make sense. Alternatives are numbers.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/home-system.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>A lifeline requires at least a role name or a class name. The selector
is optional. Note that the class name is always preceded by a colon
(&quot;:&quot;). Usually, role names are in lowercase letters, and class names are
written in CamelCase.</p>
<h2>Messages</h2>
<p>The horizontal arrows are called <strong>messages</strong>. They represent either the
transmission of a <strong>signal</strong>, or the <strong>call of an operation</strong>.</p>
<ul>
<li>
<p><strong>Signals</strong> represent information that is communicated
asynchronously between objects. So far, all messages we have seen
have referred to signals. They may refer to the physical touch of a
button, a radio transmission, the signal of a light, a sound
notification, or any other transmission of information. In the
following, many of our signals will represent units of some specific
protocol, like an MQTT or AMQP message. Signals are always
asynchronous, and therefore use always the symbol for asynchronous
messages, which is the solid line with an open arrowhead.</p>
</li>
<li>
<p>Alternatively, messages in sequence diagrams refer to <strong>operation
calls</strong>. They correspond to functions, methods or operations in
programming languages.</p>
</li>
</ul>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/math-pow.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>The figure above shows an example of a sequence diagram that shows the communication
between a Python main program <em>main.py</em> that calls the <em>pow()</em> function
of the <em>math</em> module. As you can see, this interaction is much more
complicated than the one with the signals. An operation call consists of
two messages: the message that represents the call of the operation, and
another one that shows the return of the operation. In the example, the
operation also returns a result. The messages are also drawn
differently: The call message in this example is a synchronous message,
and therefore drawn with a filled arrowhead (as opposed to the open
arrowhead of the message that describes a signal). The return message
has an open arrowhead, but is painted with a dashed line. Therefore,
this is a synchronous function call, which represents what the Python
program actually does: The calling main.py is blocked (not doing
anything) while math.py is calculating the results and then returns.</p>
<p>Sometimes the return message is left away, to reduce the visual clutter
of a diagram or just due to laziness. In this course, we don't do that
for didactic reasons, so that we can clearly distinguish the modeling of
signals from that of operation calls. If you use messages that represent
operation calls, always draw the return messages.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/math-pow-3.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>There are also situations where method calls in programming languages
are asynchronous. Then, the calling message is shown with the
asynchronous message symbol (the one with the open arrow head). In this
course, you will probably not use this and can forget about them.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/math-pow-2.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>The diagram above shows another element that is sometimes used:
<strong>execution specifications</strong>. These elements illustrate that a
participant is active. For instance, the main program is active, then
calling <em>pow()</em>, which activates the math module until it returns. In
some cases, such an illustration is very helpful, for instance to
represent recursive method calls, or illustrate design patterns. In this
course, execution specifications are optional. In many situations it is
better to focus on the messages and get them right.</p>
<h2>Creation and Destruction</h2>
<p>In some cases, it is interesting to show that a participant in an
interaction is created or destroyed as part of the interaction. This is
shown by special messages. Creation messages target the head of the
lifeline that they create. Destruction messages target a lifeline that
is then terminated with a big termination symbol. Both messages are
shown as dashed lines with an open arrow. They can be labeled with the
<em>create</em> and <em>destroy</em> stereotypes. The example below shows how the main
program creates an object of type <em>Socket</em> and then destroys it again.
Note that creation and destruction can be used independently, and that
they can be triggered by different participants in the interaction. A
lifeline can also terminate itself without a destruction message.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/create-destroy.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>What do Sequence Diagrams Represent?</h1>
<p>Let's take a step back. You have seen that sequence diagrams can
represent a wide variety of interactions, and even include elements that
are not software. Within software, we can coarsely distinguish two
different focus areas covered by sequence diagrams:</p>
<ul>
<li>
<p><strong>Local interactions</strong> <em>within a program</em>, i.e., procedure, method
or function calls.</p>
</li>
<li>
<p><strong>Distributed interactions</strong> of a system that consists of <em>several
components</em>, each running some programs.</p>
</li>
</ul>
<p>Note that both local and distributed interactions are represented with
several lifelines. In the local case, they represent different code
modules, like Java or Python classes or modules. Within both of these
interaction groups, you can use asynchronous signals or synchronous or
asynchronous operation calls. This means, there can be local signals,
and there are also distributed operation calls.</p>
<p>Sequence diagrams typically only show selected scenarios of the
interactions in a system, and do not give a complete picture. That means
they do not show all the possible exchanges of messages of a real
system, but focus only on a few but interesting ones. This may come as a
surprise. If we want to do a good specification job, don't we have to
study <em>all</em> interaction scenarios? The problem is complexity. Sequence
diagrams can quickly grow, and a na√Øve attempt to cover all scenarios
just by writing them down results in specifications that confuse rather
than clarify. Important aspects of the model will drown in too many
details, and the value of modeling is lost. There are several solutions
to this dilemma:</p>
<ul>
<li>
<p>We will complement sequence diagrams with state machines, which give
a complete picture, but on a local level only.</p>
</li>
<li>
<p>You will learn how to select the relevant and interesting
interaction scenarios that deserve attention, and leave out those
that are not relevant.</p>
</li>
<li>
<p>We will try to build interactions in such a way that the number of
possibilities is reduced.</p>
</li>
</ul>
<p>One way of making sequence diagrams more powerful and let a single
diagram express more than one scenario is by using combined fragments,
which we will look at in the next section.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>Event Orderings and Semantics</h1>
<p>Let's have a closer look at the semantics of sequence diagrams, that is,
what they mean in detail. We do this by looking at the detailed events
that happen as part of an interaction. Understanding in which order they
are supposed to happen, means to understand what the interaction really
means.</p>
<p>The passing of a message <strong>A</strong> consists of two events:</p>
<ul>
<li>
<p>The message is sent, written as <strong>!A</strong>.</p>
</li>
<li>
<p>The message is received, written as <strong>?A</strong>.</p>
</li>
</ul>
<p><strong>Ordering Rule 1:</strong> Because our universe seems to act causally, <strong>a
message must be sent before it can be received</strong>. For a message A, the
only sequence of events that is possible is <code>&lt;!A, ?A&gt;</code>.</p>
<p><strong>Ordering Rule 2:</strong> A second ordering rule is that of lifelines:
<strong>Events along the <em>same</em> lifeline are in a total order.</strong> Below, this
means that lifeline Y receives signal A before it receives B,
<code>&lt; ?A, ?B &gt;</code>.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ordering-lifeline.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>Now comes the part that may be less intuitive: Events on <em>different</em>
lifelines are <em>not ordered</em>, even though they have distinct
y-coordinates. In the diagram below, the reception of A and the
reception of B are clearly at different y-coordinates. <em>Visually</em>, A
happens before B. But this is <em>not</em> an order that the diagram implies.
Because these events are not related with each other, the diagram does
not tell if any of them happens before each other, despite it may look
like it.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-11.png" class="figure-img img-fluid rounded" alt="Despite the position on their respective lifelines, events ?A and ?B are not in any order in this diagram.">
</figure></div><aside class="col-md-4 chunk ps-2"><figcaption class="figure-caption">Despite the position on their respective lifelines, events ?A and ?B are not in any order in this diagram.</figcaption></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>For some, this non-ordering of events on different lifelines may not be
intuitive at the first glance. The following illustration may help you
to understand it: Imagine that the events along a lifeline are connected
to it by rings. The rings can move up and down along the lifeline, and
the message can get a different slope depending on the position on the
rings. Rings attached to the same lifeline cannot pass each other.
Therefore, the diagrams below all look different, but imply the same
ordering among the events, irrespective of their absolute position on
the lifelines. What counts is that <code>A</code> is received before <code>B</code>, and this
does not change in any of the diagrams.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-12.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>The slope of messages is hence only a means of illustration. A
recommendation is to use horizontal messages where possible, and
messages with a downwards slope when you want to show that messages
cross each other. (That comes later.) Avoid messages with an upwards
slope.</p>
<p>The example below shows a sequence diagram with two messages, and four
distinct events:</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-1.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>Intuitively, we already know one sequence in which these events can
happen, that is, we know that <code>&lt;!A,?A,!B,?B&gt;</code> is one valid
trace. However, it is not the only possible trace. To find the other
traces, we may start by writing down all possible different combinations
we can get from these events. With 4 events, we end up with 24 different
traces:</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><div class="source-code-frame mt-3 mb-3">
<pre class="d-none" id="id5d8253">< !A,?A,!B,?B >,
< !A,?A,?B,!B >,
< !A,!B,?A,?B >,
< !A,!B,?B,?A >,
< !A,?B,?A,!B >,
< !A,?B,!B,?A >

< ?A,!A,!B,?B >,
< ?A,!A,?B,!B >,
< ?A,!B,!A,?B >,
< ?A,!B,?B,!A >,
< ?A,?B,!A,!B >,
< ?A,?B,!B,!A >

< !B,!A,?A,?B >,
< !B,!A,?B,?A >,
< !B,?A,!A,?B >,
< !B,?A,?B,!A >,
< !B,?B,!A,?A >,
< !B,?B,?A,!A >

< ?B,!A,?A,!B >,
< ?B,!A,!B,?A >,
< ?B,?A,!A,!B >,
< ?B,?A,!B,!A >,
< ?B,!B,!A,?A >,
< ?B,!B,?A,!A >
</pre>
<button type="button" class="copy-button" data-clipboard-target="#id5d8253">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
  		<path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path>
  		<path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path>
	</svg>
</button>
<pre><code>&lt; !A,?A,!B,?B &gt;,
&lt; !A,?A,?B,!B &gt;,
&lt; !A,!B,?A,?B &gt;,
&lt; !A,!B,?B,?A &gt;,
&lt; !A,?B,?A,!B &gt;,
&lt; !A,?B,!B,?A &gt;

&lt; ?A,!A,!B,?B &gt;,
&lt; ?A,!A,?B,!B &gt;,
&lt; ?A,!B,!A,?B &gt;,
&lt; ?A,!B,?B,!A &gt;,
&lt; ?A,?B,!A,!B &gt;,
&lt; ?A,?B,!B,!A &gt;

&lt; !B,!A,?A,?B &gt;,
&lt; !B,!A,?B,?A &gt;,
&lt; !B,?A,!A,?B &gt;,
&lt; !B,?A,?B,!A &gt;,
&lt; !B,?B,!A,?A &gt;,
&lt; !B,?B,?A,!A &gt;

&lt; ?B,!A,?A,!B &gt;,
&lt; ?B,!A,!B,?A &gt;,
&lt; ?B,?A,!A,!B &gt;,
&lt; ?B,?A,!B,!A &gt;,
&lt; ?B,!B,!A,?A &gt;,
&lt; ?B,!B,?A,!A &gt;</code></pre>
</div></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>Because of the ordering rules from above, not all of these traces are
possible. The sequence diagram <em>Alpha</em> from above relates the four
events with each other.</p>
<ul>
<li>
<p>Because of message ordering, we know that only those traces are
valid ones, in which a signal is sent before it is received. This
means, <code>!A</code> must happen before <code>?A</code> and <code>!B</code> must happen before
<code>?B</code>.</p>
</li>
<li>
<p>Because of lifeline ordering, we also know that those traces, in
which events do not follow the order of the lifeline, are invalid.
This means <code>!A</code> must happen before <code>!B</code>, and <code>?A</code> must happen before
<code>?B</code>.</p>
</li>
</ul>
<p><strong>Exercise:</strong> Can you find the traces that violate any of the two
ordering rules, and strike them out?</p>
<h2>Co-Regions</h2>
<p>The diagram <em>Beta</em> below only covers the scenario that <code>A</code> is received
by <code>Y</code> before <code>B</code>.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-2.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p><strong>Exercise:</strong> Write down all the possible traces that the sequence
diagram <em>Beta</em> allows.</p>
<p>In reality, it will be hard or impossible to ensure that this order is
maintained, especially since the diagram allows to send <code>B</code> first. For a
real and robust specification, we should handle such situations. One way
is to demand from component <code>Y</code> that it must be prepared to properly
handle the arrival of messages <code>A</code> or <code>B</code> in <em>any</em> order. For that, we
can use a so-called <em>co-region</em>. These are the brackets placed on the
lifeline <em>Y</em>. Within the brackets of a co-region, events on the lifeline
are not ordered anymore, i.e., they can happen in any order.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-3.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p><strong>Exercise:</strong> Which are the <em>additional</em> traces that are possible, if
the events within the co-region (<code>?A</code> and <code>?B</code>) can happen in any order?</p>
<p><strong>Exercise:</strong> Is there a way to handle the situation also in another
way? For instance, can you, just by adding a message (and without a
co-region), reduce the number of traces so that there is only one
possible trace left for diagram <em>Beta-C</em>?</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-3-2.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>Implied Scenarios</h1>
<p>With the sequence diagrams, we describe scenarios, that means, specific
and selected examples of the system interactions. Some diagrams cover
several scenarios. In most cases, a specification (a set of diagrams)
does not document <em>all</em> possible scenarios. This is because it is often
not practical to write down all scenarios, and especially when sketching
a system it may not be relevant to think about all scenarios right at
the beginning.</p>
<p>Once a system specification gets more mature, you need to also develop
an understanding how the system handles scenarios that your
specification does not explicitly document yet. These scenarios often
exist because reality is more complicated than an idealized interaction.</p>
<p>Of course, you could just not care and leave the choice about details to
the developer who implements the system. In fact, this is what often
happens. However, this is not what you want. This may cause bugs in the
system, cost a lot of time of fixing afterwards and in general leads to
surprises later on. (And if there is one thing we want to prevent, it is
<em>surprises</em>.)</p>
<h2>Message Loss</h2>
<p>Communication protocols provide different guarantees to the application
regarding the delivery of messages. However, even the most sophisticated
protocol cannot prevent that a communication link is failing and never
recovers. In these cases, the protocol cannot &quot;hide&quot; the problem from
the application, and the application itself needs to handle the
situation. The scenario <em>Lossy_1</em> for instance also implies scenario
<em>Lossy_2</em>, i.e., that the message is not received. The loss of a
message is written with a big cross.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/lossy-12.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>So, whenever there is a diagram in which a message is sent, we should
check what would happen if this message got lost. Here are some possible
alternatives:</p>
<ul>
<li>
<p>The application is fine even if message <code>A</code> is lost. This can be the
case, for instance, if message <code>A</code> is one (of many) messages of the
same type that are sent periodically, and where it does not matter
if some of them get lost. A sensor that repeatedly sends some
measurements is a typical example. (It may be, however, important
that the sensor message <em>eventually</em> is sent, i.e., not all of them
are lost.</p>
</li>
<li>
<p>The most common solution is to use acknowledgment messages. This is
illustrated in <em>Lossy_3</em>. In case message <code>A</code> is lost, <code>Y</code> does not
send an acknowledgement. This is detected by <code>X</code> indirectly, through
the expiration of a timer. We show the timer here as a message of
<code>X</code> to itself.</p>
</li>
</ul>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/lossy-3.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h2>Non-Causal Orderings</h2>
<p>The diagram below shows an interaction between parts in a movie ticket
system. At the end of the purchase process, the terminal sends a <em>pay</em>
message to the payment component. The payment component then forwards
<em>pay_ok</em> to the ticket printer. The terminal sends the movie selection
to the printer. The printer then prints the tickets. We ignore the case
that the payment fails.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-6.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>This specification has a trouble spot. The diagram indicates that the
<em>movie</em> message is received after the <em>pay_ok</em> message. In a real
system, we often have little control on the delay of message transfer.
The payment process within <em>payment</em> may also take different amounts of
time. In a real system it is therefore difficult, undesirable or even
impossible to ensure that <em>movie</em> is received after <em>pay_ok</em>.</p>
<p>One way to fix this situation is with a co-region as in <em>Movie Fix 1</em>,
to express explicitly that the two signals can arrive at the printer in
any order. The implementation of the printer must then take care of
this.</p>
<p>Another way is to change the way the entire interaction works. Instead
of sending <em>pay_ok</em> to the printer, the payment component may also
return it to the terminal, shown in <em>Movie Fix 2</em>. The terminal can then
send the <em>movie</em> message after the payment is confirmed. In this case,
we may also use a synchronous message for the payment as in <em>Movie Fix
2x</em>, since the terminal may anyways be waiting for it and not do
anything else.</p>
<p>Note: The original sequence diagram is not wrong, but depending on the
context, type of system and the subsequent development process and
implementation, the non-causal ordering of the events may be a source of
trouble.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-7.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h2>Mixed Initiatives</h2>
<p>Consider the following alarm system. A sensor may detect an alarm and
send message <em>alarm</em> to a subscriber. The subscriber may then confirm
the alarm via message <em>confirm</em>. The alarm can also be stopped by the
sensor via <em>stop</em>. This is shown in the two diagrams below.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-8.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>The two different scenarios seem pretty straight-forward. However, these
two scenarios imply a third one: What should happen, if the alarm is
stopped by the sensor, but the subscriber confirms it, right before it
receives the stop message? We call this scenario a <em>mixed initiative</em>,
since it involves a situation where several participants may take
initiative and send a message. This situation may seem like a rare
coincidence, but it is only a matter of time and you will observe this
situation. We can illustrate it in another diagram:</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-9.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><p>So what to do about this? If you only provide the sequence diagrams
above, it is not clear how an implementation should respond in this
situation, i.e., when an alarm is both confirmed and canceled. In this
case, you need to find out what the application should do. Depending on
what kind of alarm it is, the stopping may overrule the confirmation, or
vice versa. The diagram <em>Confirm and Stop</em> shows one way to address the
mixed initiative, using a simple comment.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><figure class="figure">
    <img src="figures/ex-91.png" class="figure-img img-fluid rounded" alt="">
</figure></div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
<section class="mt-2 mb-5 py-3">
<div class="row g-0 my-3"><div class="col-md-8 px-4 chunk"><h1>Epilogue: The Value of Sequence Diagrams</h1>
<p>You may ask yourself: <em>Why should I use sequence diagrams?</em> Can't you
just immediately build a state machine or write code for your system? Of
course, you could. But then again, would you build a house before
drawing it?</p>
<p>Depending on the project, sequence diagrams may be mandatory and part of
a formal specification, or they may just be something that you scribble
on a whiteboard or a piece of paper. The actual value of writing down
interactions by sequence diagrams comes then from the following:</p>
<ol>
<li>
<p><strong>They make you think about interactions.</strong></p>
</li>
<li>
<p><strong>They enable you to explain interactions to others, discuss
interactions in team.</strong></p>
</li>
<li>
<p><strong>They let you find trouble spots.</strong></p>
</li>
<li>
<p><strong>You can resolve intricate situations.</strong></p>
</li>
</ol>
<p>So, the value of sequence diagrams depends on how they are used in the
development process, and how they effectively improve the system design.
In some cases, just the fact that you sit down and sketch some
interactions changes your view on the system, leads to good design
choices and prevents errors in the first place. A single relevant
sequence diagram, sketched on a paper that uncovers problems in your
system design early, can save millions in whatever currency.</p>
</div><aside class="col-md-4 chunk ps-2"></aside></div>
</section>
  </main>



  <nav class="navbar navbar-expand-lg navbar-dark fixed-bottom" style="background-color: #555555">
    <div class="container-fluid">
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="https://www.ntnu.no/informasjonskapsler">Om informasjonskapsler</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://www.ntnu.no/personvern">Personvern</a>
          </li>
        </ul>
        <div class="bg-light ms-auto border-0"></div>
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button"
              aria-controls="offcanvasExample">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-pencil-square" viewBox="0 0 16 16">
                <path
                  d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                <path fill-rule="evenodd"
                  d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z" />
              </svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasExample"
    aria-labelledby="offcanvasExampleLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasExampleLabel">Edit this page</h5>
    </div>
    <div class="offcanvas-body">
      <ul>
        <li>This site is hosted on <a href="https://github.com/falkr/ttm41751">Github</a></li>
        <li>The source is written in <a href="../supermark/index.html">Supermark</a> syntax</li>
        <li>To edit this page, make a commit to <a
            href="https://github.com/falkr/ttm4175/tree/master/pages/unit-8-sd/preparation-1.md">this file</a></li>
      </ul>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <script>
    anchors.add('h1').add('h2').add('h3');
    anchors.options.visible = 'always';
    var clipboard = new ClipboardJS('.copy-button');
  </script>
  <script>
</script>
</body>

</html>